# Prac04 

## timer - highwater mark

We will add an interrupt generated by a timer to invoke the  highwater mark printout to the serial console. Recall that the earlier code ran the task once 5 seconds after the start of execution to give us a snapshot of the memory usage by each task.

Now we will modify it to run every 10 seconds so we can see if the memory requirement changes over time.

We will utilize a FreeRTOS function called **xTimerCreate** to  set up a time; the arguments passed to the *xTimerCreate* function include:

- descriptive name for the timer (text)
- number of ticks between timer events (10000 ms)
- repeat indicator (if set to pdFALSE it only triggers one time)
- timer ID (not used here)
- callback function to execute when a timer event occurs

The *xTimerStart* functions accepts arguments for the timer handle name and the time to wait for the timer queue to be available. 

## mutexes - serial console

Let’s add the ability to enter and respond to commands entered on the serial console. 

This will give us a way to interact with our device without adding more buttons to push — but it also uncovers a potential problem:

What happens if the highwater event decides to display its data on the console at the same time the command processor is writing to it?

Mutex is used to allow a task to reserve exclusive access to shared resources for a period of time. When the task no longer requires exclusive access to the resource it can (actually MUST) release the mutex so that other tasks can proceed to use the resource.

What is the difference between the mutex semaphore and a semaphore? Since the mutex is mutually exclusive the only task that can release it is the one that one that took it.

